---
author: chris.hill
comments: true
date: 2013-09-29
excerpt: 通过sort命令实现对ip地址进行排序
layout: post
slug: order-ip-addresses-by-sort
title: 通过sort命令实现对ip地址进行排序
categories:
- 脚本工具
tags:
- Shell
---

* * *





# sort命令




    
    
```sh
sort -n -t . -k 1,1 -k 2,2 -k 3,3 -k 4,4
```




<!-- more -->

# 分析





ip地址示例文件




    
```sh
cat addresses.txt
```




内容如下

```
  129.95.30.40  

  5.24.69.2  

  19.20.203.5  

  1.2.3.4  

  19.20.21.22  

  5.220.100.50
```






sort默认会按照字母表顺序进行排序。





如下




    
```sh
sort addresses.txt
```





输出结果如下 
  
```
  1.2.3.4  

  129.95.30.40  

  19.20.203.5  

  19.20.21.22  

  5.220.100.50  

  5.24.69.2
```






以上结果显然不是我们所期望的。





# 改进方法





使用–numeric-sort (-n) 选项，sort会按照数字进行排序，但结果还是有些差强人意。




    
```sh
sort -n addresses.txt
```

输出如下



```
  1.2.3.4  

  5.220.100.50  

  5.24.69.2  

  19.20.203.5  

  19.20.21.22  

  129.95.30.40
```






我们分析可知，sort通过点号（.）分开的数值进行对比，仅仅第一组数值对比正确，其后的对比排序并不符合我们的预期。





比如




```
    5.220.100.50  

    5.24.69.2
```







我们希望5.24.69.2在5.220.100.50的前面进行排序。





# 完美方案




    
```sh
sort -n -t . -k 1,1 -k 2,2 -k 3,3 -k 4,4 addresses.txt
```





显示结果如下




```
  1.2.3.4  

  5.24.69.2  

  5.220.100.50  

  19.20.21.22  

  19.20.203.5  

  129.95.30.40
```






解释说明：


  * -n    根据数值进行排序   
  * -t    指定使用点号(.)作为字段分隔符   
  * -k 2,2    从第2个字段（列）开始比较排序，到第2字段结束   





# 参考资料





<http://www.madboa.com/geek/sort-addr/>





* * *





作者：chris hill





微博：[@翻滚的蜗牛blog](http://www.weibo.com/weittor)



